<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MSTV Network</title>

<style>
/* ===== Global Reset & Styles ===== */
* { box-sizing: border-box; }
body { margin: 0; padding: 0; font-family: 'Poppins', sans-serif; color: #E0E0E0; background: #0F1115; }

.title-3d {
  font-size: clamp(1.8rem, 4vw, 3.5rem);
  text-align: center;
  margin: 20px 0 10px;
  color: #FFFFFF;
  letter-spacing: 2px;
  font-weight: 700;
}

.scrolling-news {
  background: #1A1D20; color: #90EE90; padding: 10px 0;
  border-top: 1px solid #333; border-bottom: 1px solid #333;
  margin-bottom: 20px; font-weight: 500;
}

.channel-selector-text { text-align: center; font-size: clamp(1.2rem, 3vw, 1.8rem); margin: 2vh 0 2vh; font-weight: 600; }
.channel-selection { display: flex; justify-content: center; padding: 0 15px; margin-bottom: 5vh; }

select {
  width: 100%; max-width: 500px; padding: 12px; font-size: 1.1rem;
  background: #1A1D20; color: #90EE90; border: 1px solid #90EE90;
  border-radius: 8px; text-align: center; outline: none; cursor: pointer;
}

/* ===== Player Container ===== */
.player-container {
  position: relative; width: 95%; max-width: 1200px; margin: 0 auto 30px;
  border-radius: 12px; overflow: hidden; background: #000;
  box-shadow: 0 8px 20px rgba(0,0,0,0.8);
}

.player-container:fullscreen { width: 100vw; height: 100vh; max-width: none; border-radius: 0; }
.player-container:-webkit-full-screen { width: 100vw; height: 100vh; }

.player-container::before { content: ""; display: block; padding-top: 56.25%; }

.player-container iframe, .player-container video, #placeholder-image {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: contain; border: none;
}

/* ===== Loading Overlay & Spinner ===== */
.loading-indicator {
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.85); display: none; flex-direction: column;
  align-items: center; justify-content: center; z-index: 50;
}

.spinner {
  border: 4px solid rgba(255, 255, 255, 0.1);
  border-left-color: #90EE90;
  border-radius: 50%; width: 50px; height: 50px;
  animation: spin 1s linear infinite;
  margin-bottom: 15px;
}

@keyframes spin { to { transform: rotate(360deg); } }

.loading-text { color: #90EE90; font-size: 1.2rem; font-weight: 500; }

.fs-btn {
  position: absolute; bottom: 15px; right: 15px;
  background: rgba(0, 0, 0, 0.7); color: white; border: 1px solid #90EE90;
  padding: 8px 12px; border-radius: 4px; cursor: pointer; z-index: 60; display: none;
}

.live-stamp {
  position: absolute; top: 15px; left: 15px;
  background: #E50914; color: white; font-weight: 700;
  padding: 6px 14px; border-radius: 6px; z-index: 10; display: none;
}

footer { background: #000; color: #888; text-align: center; padding: 40px 20px; border-top: 1px solid #222; }
.fb-link { display: inline-flex; align-items: center; text-decoration: none; color: #ffffff; background: #1877F2; padding: 10px 20px; border-radius: 50px; font-weight: bold; }
</style>
</head>
<body>

<div class="title-3d">AAINA DTH FREE</div>

<div class="scrolling-news">
    <marquee behavior="scroll" direction="left" scrollamount="6">Welcome to MSTV Network - AAINA DTH FREE! High-quality streaming 24/7.</marquee>
</div>

<div class="channel-selector-text">Select Channel</div>
<div class="channel-selection">
    <select id="channel-select"><option value="">ðŸ‘‰ Choose a Channel</option></select>
</div>

<div class="player-container" id="main-player-container">
    <!-- onload event added for iframe tracking -->
    <iframe id="media-player" onload="iframeFinishedLoading()" allow="autoplay; encrypted-media; picture-in-picture; fullscreen" sandbox="allow-scripts allow-same-origin allow-presentation" style="display:none;"></iframe>
    <video id="video-player" autoplay playsinline controls style="display:none;"></video>
    <img id="placeholder-image" src="Design-Studio-2025-01-22 (1).png">
    
    <div class="live-stamp" id="live-stamp">MSTV NETWORK</div>
    
    <div class="loading-indicator" id="loading">
        <div class="spinner"></div>
        <div class="loading-text" id="loading-msg">Connecting...</div>
    </div>
    
    <button class="fs-btn" id="fs-toggle" onclick="toggleFullscreen()">â›¶ Fullscreen</button>
</div>

<div class="fb-follow-container" style="text-align:center; margin-bottom:60px;">
    <a href="https://www.facebook.com" target="_blank" class="fb-link">Follow us on Facebook</a>
</div>

<footer>
    <div class="footer-content">
        <h3>About Us</h3>
        <p>MSTV Network - Premier digital entertainment platform.</p>
        <div class="copyright">&copy; <span id="year"></span> MSTV Network.</div>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net"></script>

<script>
document.getElementById('year').textContent = new Date().getFullYear();

const select = document.getElementById('channel-select');
const videoPlayer = document.getElementById('video-player');
const iframePlayer = document.getElementById('media-player');
const placeholder = document.getElementById('placeholder-image');
const loading = document.getElementById('loading');
const loadingMsg = document.getElementById('loading-msg');
const fsBtn = document.getElementById('fs-toggle');
const container = document.getElementById('main-player-container');
const liveStamp = document.getElementById('live-stamp');

let hlsInstance = null;
let currentChannelType = null;


channelsData.forEach((ch, i) => {
  let opt = document.createElement('option');
  opt.value = i; opt.textContent = ch.name;
  select.appendChild(opt);
});

function toggleFullscreen() {
  if (!document.fullscreenElement && !document.webkitFullscreenElement) {
    if (container.requestFullscreen) container.requestFullscreen();
    else if (container.webkitRequestFullscreen) container.webkitRequestFullscreen();
  } else {
    if (document.exitFullscreen) document.exitFullscreen();
    else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
  }
}

// Triggered specifically when Zee Cinema or other iframe pages finish loading
function iframeFinishedLoading() {
    if (currentChannelType === "iframe" && iframePlayer.src !== "" && iframePlayer.src !== window.location.href) {
        loading.style.display = 'none';
        fsBtn.style.display = 'block';
        setTimeout(toggleFullscreen, 500); 
    }
}

function stopAllPlayback() {
  if (hlsInstance) { hlsInstance.destroy(); hlsInstance = null; }
  videoPlayer.pause(); videoPlayer.removeAttribute('src'); videoPlayer.load();
  videoPlayer.style.display = 'none';
  iframePlayer.src = ""; iframePlayer.style.display = 'none';
  liveStamp.style.display = 'none';
  fsBtn.style.display = 'none';
  currentChannelType = null;
}

function playChannel(channel) {
  stopAllPlayback();
  if (!channel) { placeholder.style.display = 'block'; return; }
  
  currentChannelType = channel.type;
  loading.style.display = 'flex';
  loadingMsg.innerText = "Loading " + channel.name + "...";
  placeholder.style.display = 'none';

  if (channel.type === "hls") {
    videoPlayer.style.display = "block";
    if (videoPlayer.canPlayType('application/vnd.apple.mpegurl')) {
      videoPlayer.src = channel.url;
      videoPlayer.play().then(() => { loading.style.display = 'none'; fsBtn.style.display = 'block'; setTimeout(toggleFullscreen, 500); });
    } else if (Hls.isSupported()) {
      hlsInstance = new Hls();
      hlsInstance.loadSource(channel.url);
      hlsInstance.attachMedia(videoPlayer);
      hlsInstance.on(Hls.Events.MANIFEST_PARSED, () => {
        videoPlayer.play().then(() => { loading.style.display = 'none'; fsBtn.style.display = 'block'; setTimeout(toggleFullscreen, 800); });
      });
    }
  } else {
    // Iframe Path (Zee Cinema)
    iframePlayer.src = channel.url;
    iframePlayer.style.display = "block";
    liveStamp.style.display = "block";
    // loading is hidden by iframeFinishedLoading() above
  }
}

select.addEventListener("change", () => {
  if (select.value !== "") playChannel(channelsData[select.value]);
  else playChannel(null);
});
</script>
</body>
</html>
